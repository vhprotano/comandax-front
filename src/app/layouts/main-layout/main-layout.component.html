<div class="main-layout">
  <!-- Mobile Header -->
  <header class="mobile-header md:hidden">
    <button class="menu-toggle" (click)="openOffcanvas(offcanvasMenu)">
      <span class="hamburger-icon">â˜°</span>
    </button>
    <h1 class="app-title">ComandaX</h1>
    <button class="logout-btn fs-6" (click)="logout()">
      <span>Sair</span>
    </button>
  </header>

  <!-- Desktop Sidebar -->
  <aside class="sidebar hidden md:flex" [class.collapsed]="sidebarCollapsed">
    <div class="sidebar-header">
      <!-- <button class="sidebar-toggle" (click)="toggleSidebar()" title="Expandir/Recolher Menu">
        <lucide-angular *ngIf="!sidebarCollapsed" [img]="ChevronLeft" [size]="20" [strokeWidth]="2"></lucide-angular>
        <lucide-angular *ngIf="sidebarCollapsed" [img]="ChevronRight" [size]="20" [strokeWidth]="2"></lucide-angular>
      </button> -->
      @if (!sidebarCollapsed) {
      <div class="logo-container">
        <!-- <div class="logo-icon">ğŸ½ï¸</div>
        <div class="logo-text">
          <h1 class="sidebar-title">ComandaX</h1>
          <p class="sidebar-subtitle">Sistema Unificado</p>
        </div> -->
        <img src="assets/logo/transparente.png" alt="ComandaX Logo" class="logo-image" />
      </div>
      }
      <!-- <div class="logo-icon-only" *ngIf="sidebarCollapsed">
        ğŸ½ï¸
      </div> -->
    </div>

    <nav class="sidebar-nav">
      @for (item of menuItems; track item.id) {
        <!-- Separator -->
        @if (item.id === 'separator') {
        <div class="menu-separator"></div>
        }

        <!-- Menu Item with Children -->
        @if (item.id !== 'separator' && item.children) {
        <div class="menu-group">
          <button class="menu-item" (click)="toggleMenu(item.id)" [class.expanded]="isMenuExpanded(item.id)"
            [title]="sidebarCollapsed ? item.label : ''">
            <span class="menu-icon">{{ item.icon }}</span>
            @if (!sidebarCollapsed) {
            <span class="menu-label">{{ item.label }}</span>
            }
            @if (isMenuExpanded(item.id)) {
            <lucide-angular [img]="ChevronLeft" [size]="20"
              [strokeWidth]="2"></lucide-angular>
            }
            @if (!isMenuExpanded(item.id)) {
            <lucide-angular [img]="ChevronRight" [size]="20"
              [strokeWidth]="2"></lucide-angular>
            }
          </button>

          @if (isMenuExpanded(item.id) && !sidebarCollapsed) {
          <div class="submenu">
            @for (child of item.children; track child.id) {
            <button class="submenu-item" [class.active]="isActiveRoute(child.route)"
              (click)="navigate(child.route!)">
              <span class="menu-icon">{{ child.icon }}</span>
              <span class="menu-label">{{ child.label }}</span>
            </button>
            }
          </div>
          }
        </div>
        }

        <!-- Simple Menu Item -->
        @if (item.id !== 'separator' && !item.children) {
        <button class="menu-item"
          [class.active]="isActiveRoute(item.route)" [class.disabled]="item.disabled"
          [title]="item.tooltip || (sidebarCollapsed ? item.label : '')"
          (click)="!item.disabled && navigate(item.route!)">
          <span class="menu-icon">{{ item.icon }}</span>
          <span class="menu-label" *ngIf="!sidebarCollapsed">{{ item.label }}</span>
          @if (item.disabled && !sidebarCollapsed) {
          <span class="badge-soon">Em Breve</span>
          }
        </button>
        }
      }
    </nav>

    <div class="sidebar-footer">
      <button class="logout-button" (click)="logout()">
        <span class="menu-icon">ğŸšª</span>
        <span class="menu-label">Sair</span>
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content" [class.sidebar-collapsed]="sidebarCollapsed">
    <router-outlet></router-outlet>
  </main>
</div>

<!-- Mobile Offcanvas Menu -->
<ng-template #offcanvasMenu let-offcanvas>
  <div class="offcanvas-header">
    <h2 class="offcanvas-title">ComandaX</h2>
    <button type="button" class="close-btn" (click)="offcanvas.dismiss()">
      âœ•
    </button>
  </div>

  <div class="offcanvas-body">
    <nav class="mobile-nav">
      @for (item of menuItems; track item.id) {
        <!-- Separator -->
        @if (item.id === 'separator') {
        <div class="menu-separator"></div>
        }

        <!-- Menu Item with Children -->
        @if (item.id !== 'separator' && item.children) {
        <div class="menu-group">
          <button class="menu-item" (click)="toggleMenu(item.id)" [class.expanded]="isMenuExpanded(item.id)">
            <span class="menu-icon">{{ item.icon }}</span>
            <span class="menu-label">{{ item.label }}</span>
            @if (isMenuExpanded(item.id)) {
            <lucide-angular [img]="ChevronLeft" [size]="20"
              [strokeWidth]="2"></lucide-angular>
            }
            @if (!isMenuExpanded(item.id)) {
            <lucide-angular [img]="ChevronRight" [size]="20"
              [strokeWidth]="2"></lucide-angular>
            }
          </button>

          @if (isMenuExpanded(item.id)) {
          <div class="submenu">
            @for (child of item.children; track child.id) {
            <button class="submenu-item" [class.active]="isActiveRoute(child.route)"
              (click)="navigate(child.route!)">
              <span class="menu-icon">{{ child.icon }}</span>
              <span class="menu-label">{{ child.label }}</span>
            </button>
            }
          </div>
          }
        </div>
        }

        <!-- Simple Menu Item -->
        @if (item.id !== 'separator' && !item.children) {
        <button class="menu-item"
          [class.active]="isActiveRoute(item.route)" [class.disabled]="item.disabled" [title]="item.tooltip || ''"
          (click)="!item.disabled && navigate(item.route!)">
          <span class="menu-icon">{{ item.icon }}</span>
          <span class="menu-label">{{ item.label }}</span>
          @if (item.disabled) {
          <span class="badge-soon">Em Breve</span>
          }
        </button>
        }
      }
    </nav>
  </div>
</ng-template>