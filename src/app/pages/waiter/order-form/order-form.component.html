<div class="min-h-screen bg-gray-50">
  <!-- Header -->
  <header class="bg-white shadow-sm border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <button (click)="cancel()" class="text-2xl hover:opacity-70">‚Üê</button>
        <h1 class="text-2xl font-bold text-gray-900">Nova Comanda</h1>
      </div>
    </div>
  </header>

  <!-- Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Products Section -->
      <div class="lg:col-span-2 space-y-6">
        <!-- Order Info -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h2 class="text-lg font-bold text-gray-900 mb-4">Informa√ß√µes da Comanda</h2>

          <!-- Order Type Selection -->
          <div class="mb-4 flex gap-2">
            <button
              type="button"
              (click)="orderType = 'table'"
              [class.ring-2]="orderType === 'table'"
              [class.ring-primary-600]="orderType === 'table'"
              [class.bg-primary-50]="orderType === 'table'"
              class="flex-1 p-3 border-2 border-gray-200 rounded-lg hover:border-primary-600 transition-all font-medium text-sm"
            >
              ü™ë Mesa
            </button>
            <button
              type="button"
              (click)="orderType = 'delivery'"
              [class.ring-2]="orderType === 'delivery'"
              [class.ring-primary-600]="orderType === 'delivery'"
              [class.bg-primary-50]="orderType === 'delivery'"
              class="flex-1 p-3 border-2 border-gray-200 rounded-lg hover:border-primary-600 transition-all font-medium text-sm"
            >
              üöö Entrega
            </button>
          </div>

          <form [formGroup]="orderForm" class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Nome do Cliente</label>
              <input
                type="text"
                formControlName="customer_name"
                placeholder="Ex: Jo√£o Silva"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"
              />
            </div>
            <!-- Table Selection (only for table orders) -->
            <div *ngIf="orderType === 'table'">
              <label class="block text-sm font-medium text-gray-700 mb-1">
                {{ useTableSelection ? 'Selecione a Mesa' : 'N√∫mero da Mesa' }}
              </label>
              <div *ngIf="useTableSelection && tables.length > 0" class="grid grid-cols-3 gap-2">
                <button
                  *ngFor="let table of tables"
                  type="button"
                  (click)="orderForm.patchValue({ table_number: table.number })"
                  [class.ring-2]="orderForm.get('table_number')?.value === table.number"
                  [class.ring-primary-600]="orderForm.get('table_number')?.value === table.number"
                  [class.bg-primary-50]="orderForm.get('table_number')?.value === table.number"
                  class="p-3 border-2 border-gray-200 rounded-lg hover:border-primary-600 transition-all text-center font-medium"
                >
                  ü™ë {{ table.number }}
                </button>
              </div>
              <input
                *ngIf="!useTableSelection"
                type="text"
                formControlName="table_number"
                placeholder="Ex: Mesa 5"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"
              />
            </div>

            <!-- Delivery Options (only for delivery orders) -->
            <div *ngIf="orderType === 'delivery'" class="space-y-3">
              <label class="block text-sm font-medium text-gray-700">Quando preparar?</label>
              <div class="flex gap-2">
                <button
                  type="button"
                  (click)="deliveryTime = 'now'"
                  [class.ring-2]="deliveryTime === 'now'"
                  [class.ring-primary-600]="deliveryTime === 'now'"
                  [class.bg-primary-50]="deliveryTime === 'now'"
                  class="flex-1 p-2 border-2 border-gray-200 rounded-lg hover:border-primary-600 transition-all font-medium text-sm"
                >
                  ‚ö° Preparar Agora
                </button>
                <button
                  type="button"
                  (click)="deliveryTime = 'scheduled'"
                  [class.ring-2]="deliveryTime === 'scheduled'"
                  [class.ring-primary-600]="deliveryTime === 'scheduled'"
                  [class.bg-primary-50]="deliveryTime === 'scheduled'"
                  class="flex-1 p-2 border-2 border-gray-200 rounded-lg hover:border-primary-600 transition-all font-medium text-sm"
                >
                  üïê Agendar
                </button>
              </div>
              <div *ngIf="deliveryTime === 'scheduled'">
                <label class="block text-sm font-medium text-gray-700 mb-1">Hor√°rio de Entrega</label>
                <input
                  type="time"
                  [(ngModel)]="scheduledTime"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"
                />
              </div>
            </div>
          </form>
        </div>

        <!-- Categories -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h2 class="text-lg font-bold text-gray-900 mb-4">Categorias</h2>
          <div class="flex gap-2 flex-wrap">
            <button
              *ngFor="let category of categories"
              (click)="selectedCategory = category.id"
              [class.ring-2]="selectedCategory === category.id"
              [class.ring-primary-600]="selectedCategory === category.id"
              class="px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors font-medium text-sm"
            >
              {{ category.icon }} {{ category.name }}
            </button>
          </div>
        </div>

        <!-- Products Grid -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h2 class="text-lg font-bold text-gray-900 mb-4">Produtos</h2>
          <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
            <button
              *ngFor="let product of getProductsByCategory()"
              (click)="addToCart(product)"
              class="p-4 border-2 border-gray-200 rounded-lg hover:border-primary-600 hover:bg-primary-50 transition-all text-left"
            >
              <p class="font-semibold text-gray-900">{{ product.name }}</p>
              <p class="text-primary-600 font-bold mt-2">R$ {{ product.price.toFixed(2) }}</p>
            </button>
          </div>
        </div>
      </div>

      <!-- Cart Section -->
      <div class="lg:col-span-1">
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 sticky top-8">
          <h2 class="text-lg font-bold text-gray-900 mb-4">Carrinho</h2>

          <div class="space-y-3 mb-6 max-h-96 overflow-y-auto">
            <div *ngFor="let item of cartItems" class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
              <div class="flex-1">
                <p class="text-sm font-medium text-gray-900">{{ item.product_name }}</p>
                <p class="text-xs text-gray-600">R$ {{ item.unit_price.toFixed(2) }}</p>
              </div>
              <div class="flex items-center gap-2">
                <input
                  type="number"
                  [value]="item.quantity"
                  (change)="updateQuantity(item.id, +$event.target.value)"
                  min="1"
                  class="w-12 px-2 py-1 border border-gray-300 rounded text-center text-sm"
                />
                <button
                  (click)="removeFromCart(item.id)"
                  class="text-red-600 hover:text-red-700 font-bold"
                >
                  ‚úï
                </button>
              </div>
            </div>

            <div *ngIf="cartItems.length === 0" class="text-center py-8">
              <p class="text-gray-600 text-sm">Nenhum item adicionado</p>
            </div>
          </div>

          <!-- Total -->
          <div class="border-t border-gray-200 pt-4 mb-4">
            <div class="flex items-center justify-between mb-2">
              <span class="text-gray-600">Subtotal:</span>
              <span class="font-semibold text-gray-900">R$ {{ total.toFixed(2) }}</span>
            </div>
            <div class="flex items-center justify-between text-lg font-bold">
              <span class="text-gray-900">Total:</span>
              <span class="text-primary-600">R$ {{ total.toFixed(2) }}</span>
            </div>
          </div>

          <!-- Actions -->
          <div class="space-y-2">
            <button
              (click)="submitOrder()"
              class="w-full px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-bold"
            >
              Enviar para Cozinha
            </button>
            <button
              (click)="cancel()"
              class="w-full px-4 py-2 bg-gray-200 text-gray-900 rounded-lg hover:bg-gray-300 transition-colors font-medium"
            >
              Cancelar
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

